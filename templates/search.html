<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="../static/style.css">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css">
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://code.jquery.com/ui/1.12.1/jquery-ui.min.js"></script>
    <script type="text/javascript" src="{{url_for('static', filename='search.js')}}"></script>
    <style>
        #container { display: flex; }
        #filter-section { width: 20%; }
        #result-section { width: 80%; }
    </style>
    <title>Search result</title>
</head>
<body>
    <div id="header">
        <h1><a href="/">Anime Atlas</a></h1>
        <form action="/description" method="post">
            <input type="text" name="Mod_name" placeholder="Enter anime name" list="anime-suggestions">
            <datalist id="anime-suggestions">
                <!-- Suggestions will be dynamically filled here -->
            </datalist>
            <button type="submit">Search</button>
        </form>
    </div>

    <div id="container">
        <div id="filter-section">
            <h2>Filters</h2>
            <form id="filter-form">
                <label for="genre">Genre:</label>
                <select name="genre" hx-get="/filter" hx-target="#result-section" hx-indicator="#loading" hx-trigger="change">
                    <option value="">Select Genre</option>
                    <option value="Action">Action</option>
                    <option value="Adventure">Adventure</option>
                    <option value="Comedy">Comedy</option>
                    <option value="Drama">Drama</option>
                    <option value="Fantasy">Fantasy</option>
                    <option value="Horror">Horror</option>
                    <option value="Music">Music</option>
                    <option value="Romance">Romance</option>
                    <option value="School">School</option>
                    <option value="Sci-Fi">Sci-Fi</option>
                    <!-- Add more genres as needed -->
                </select>
                <br />
                <label for="type">Type:</label>
                <select name="type" hx-get="/filter" hx-target="#result-section" hx-indicator="#loading" hx-trigger="change">
                    <option value="">Select Type</option>
                    <option value="TV">TV</option>
                    <option value="Movie">Movie</option>
                    <option value="Music">Movie</option>
                    <option value="ONA">Movie</option>
                    <option value="OVA">Movie</option>
                    <option value="Special">Movie</option>
                </select>
                <!-- Additional filters can be added here -->
            </form>
        </div>
        <div id="result-section">
            <h2>Search Results</h2>
            <div id="loading" style="display:none;">Loading...</div>
            <!-- Results will be loaded here -->

            {% if results %}
                {% for anime in results %}
                    <div class="overlay">
                        <h1>
                            <a href="/description?Mod_name={{ anime['Mod_name'] }}">
                                {% if anime['English name'] == "UNKNOWN" %}
                                    {{ anime['Name'] }}
                                {% else %}
                                    {{ anime['English name'] }}
                                {% endif %}
                            </a>
                        </h1>
                        <img src="{{ anime['Image URL'] }}" alt="{{ anime['Name'] }}" class="img-fluid">
                        <p><strong>Genres:</strong> {{ anime['Genres'] }}</p>
                        <p><strong>Type:</strong> {{ anime['Type'] }}</p>
                        <p><strong>Synopsis:</strong> {{ anime['Synopsis'] }}</p>
                    </div>
                {% endfor %}
            {% endif %}

        </div>
    </div>
</body>
</html>
